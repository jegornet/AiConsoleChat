СТРУКТУРА ПРОЕКТА AiConsoleChat
================================

Описание функциональности каждого Python файла в проекте:

1. main.py
----------
Точка входа приложения. Координирует работу всех компонентов:
- Загружает переменные окружения
- Инициализирует основные классы (MCPConnection, ClaudeChat, ChatInterface)
- Загружает конфигурацию MCP серверов
- Устанавливает соединение с MCP сервером
- Запускает интерактивный чат-интерфейс
- Обеспечивает корректное завершение работы и очистку ресурсов

2. config.py
------------
Файл конфигурации с константами приложения:
- MODEL: модель Claude для использования ("claude-3-5-haiku-latest")
- MAX_TOKENS: максимальное количество токенов в ответе (4000)
- IS_MULTILINE: режим многострочного ввода (по умолчанию False)
- SYSTEM_PROMPT: системное сообщение для Claude бота

3. mcp_connection.py
-------------------
Класс MCPConnection для работы с MCP (Model Context Protocol) серверами:
- Управляет подключением к MCP серверам через stdio
- Получает список доступных инструментов от сервера
- Выполняет вызовы инструментов с обработкой ошибок
- Предоставляет асинхронный интерфейс для взаимодействия
- Управляет жизненным циклом соединения и очисткой ресурсов

4. claude_chat.py
----------------
Класс ClaudeChat для взаимодействия с API Anthropic Claude:
- Обрабатывает запросы пользователя через Claude API
- Управляет настройками токенов (get/set max_tokens)
- Реализует логику итеративного выполнения запросов с инструментами
- Обрабатывает цепочки вызовов инструментов и ответов
- Форматирует финальный ответ для пользователя

5. chat_interface.py
-------------------
Класс ChatInterface для управления пользовательским интерфейсом:
- Реализует интерактивный чат-интерфейс с командами
- Обрабатывает команды: /quit, /max_tokens, /multiline
- Поддерживает однострочный и многострочный режимы ввода
- Управляет буфером многострочного ввода
- Отображает справочную информацию и статус системы

6. mcp_config_loader.py
----------------------
Класс McpConfigLoader для загрузки конфигурации MCP серверов:
- Загружает и валидирует файл конфигурации mcp.json
- Проверяет наличие и корректность конфигурации серверов
- Предоставляет методы для получения конфигурации первого сервера
- Обрабатывает ошибки загрузки и парсинга конфигурации

7. mcp_server.py
---------------
MCP сервер для работы с файловой системой:
- Реализует MCP сервер с инструментами для файловых операций
- Предоставляет инструменты: list_files, read_file, write_file, delete_file
- Обеспечивает безопасность через ограничение доступа к рабочей директории
- Обрабатывает различные кодировки файлов (UTF-8, Latin-1)
- Автоматически создает директории при записи файлов

АРХИТЕКТУРА
-----------
Проект следует принципу единственной ответственности (Single Responsibility Principle):
- Каждый класс отвечает за конкретную функциональность
- Разделение на слои: UI (chat_interface), бизнес-логика (claude_chat), 
  сетевое взаимодействие (mcp_connection), конфигурация (config, mcp_config_loader)
- main.py служит только как точка входа и координатор компонентов
- mcp_server.py - отдельный сервис для файловых операций

ЗАВИСИМОСТИ
-----------
Внешние библиотеки:
- anthropic: для работы с Claude API
- mcp: для реализации Model Context Protocol
- dotenv: для загрузки переменных окружения
- fastmcp: для создания MCP сервера

Внутренние зависимости:
- main.py зависит от всех остальных модулей
- claude_chat.py использует config.py
- chat_interface.py использует config.py
- Остальные модули независимы друг от друга